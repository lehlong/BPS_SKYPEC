@model SMO.Models.DataCenterModel
@using SMO.Models;
@using System.Text;

<style>
   
    table {
        position: relative;
        border-collapse: collapse;
    }
    thead {
        position: -webkit-sticky;
        position: sticky;
        top: 0;
        z-index: 2;
        background: #eee;
    }
    .frozen {
        position: -webkit-sticky; /* for Safari */
        position: sticky;
        left: 0;
        background: #eee;
    }

    td, th, tr {
        border: solid 1px #c2c2c2 !important;
    }
    
</style>
<ul class="nav nav-tabs" role="tablist" style="width: 100%; display: flex;">
    <li role="presentation" class="active" style="cursor: pointer;">
        <a href="#tab-1" title="Kế hoạch theo tháng" data-toggle="tab">KH Nhập nhiên liệu</a>
    </li>
    <li role="presentation" style="cursor: pointer;">
        <a href="#tab-2" title="Kế hoạch theo tháng" data-toggle="tab">KH giá vốn</a>
    </li>
</ul>
<div class="tab-content" style="padding-bottom:0">
    <div role="tabpanel" class="tab-pane fade in active" id="tab-1">
        <div class="sticky-table sticky-headers sticky-ltr-cells table-screen table">
            <div class="table-responsive" style="height:calc(100vh - 180px); width:100%">
                <table class="table table-condensed table-bordered table-striped" style="text-align:center">
                    <thead>
                        <tr>
                            <th rowspan="2" class="frozen">Kho đầu nguồn</th>
                            <th rowspan="2" >Khu vực</th>
                            <th rowspan="2">ĐK giao hàng</th>
                            <th colspan="2" class="align-center">Tỷ lệ nhập</th>
                            <th rowspan="2">Platt's ($/thùng)</th>
                            <th colspan="2" class="align-center">Premium</th>
                            <th rowspan="2">CFR ($/thùng)</th>
                            <th rowspan="2">Thùng/tấn</th>
                            <th rowspan="2">Giá CFR ($/tấn)</th>
                            <th rowspan="2">Bảo hiểm ($/tấn)</th>
                            <th colspan="2" class="align-center">Thuế NK</th>
                            <th rowspan="2">CIF + tấn ($/tấn)</th>
                            <th rowspan="2">CIF + tấn ($/tấn) BQ</th>
                            <th rowspan="2">CIF + tấn ($/tấn) BQ</th>
                            <th rowspan="2">Pre + BH ($/thùng)</th>
                            <th rowspan="2"></th>
                            <th rowspan="2">Giảm trừ thuế hàng <br /> Dung Quất + Form D</th>
                        </tr>
                        <tr>
                            <th>Tỷ lệ nhập theo kho</th>
                            <th>SL nhập theo kho</th>
                            <th>Hàng (thùng)</th>
                            <th>Tàu</th>
                            <th>Thuế suất</th>
                            <th>Thuế ($/tấn)</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.KeHoachGiaThanhData.OrderBy(x => x.AreaCode).ThenBy(x => x.Warehouse))
                        {
                            if (item.S0001 == 0 && item.S0002 == 0 && item.U0001 == 0 && item.S0003 == 0 && item.S0004 == 0
                                && item.U0002 == 0 && item.S0005 == 0 && item.U0003 == 0 && item.S0006 == 0 && item.S0007 == 0
                                && item.U0004 == 0 && item.U0005 == 0 && item.U0006 == 0 && item.U0007 == 0 && item.U0008 == 0
                                && item.U0009 == 0 && item.U0010 == 0)
                            {
                                continue;
                            }
                            <tr>
                                <td  class="frozen">@item.Warehouse</td>
                                <td>@item.AreaCode</td>
                                <td>@item.DeliveryConditions</td>
                                <td>@item.S0001.ToStringVN()</td>
                                <td>@item.S0002.ToStringVN()</td>
                                <td>@item.U0001.ToStringVN()</td>
                                <td>@item.S0003.ToStringVN()</td>
                                <td>@item.S0004.ToStringVN()</td>
                                <td>@item.U0002.ToStringVN()</td>
                                <td>@item.S0005.ToStringVN()</td>
                                <td>@item.U0003.ToStringVN()</td>
                                <td>@item.S0006.ToStringVN()</td>
                                <td>@item.S0007.ToStringVN()</td>
                                <td>@item.U0004.ToStringVN()</td>
                                <td>@item.U0005.ToStringVN()</td>
                                <td>@item.U0006.ToStringVN()</td>
                                <td>@item.U0007.ToStringVN()</td>
                                <td>@item.U0008.ToStringVN()</td>
                                <td>@item.U0009.ToStringVN()</td>
                                <td>@item.U0010.ToStringVN()</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div role="tabpanel" class="tab-pane fade in" id="tab-2">
        <div class="sticky-table sticky-headers sticky-ltr-cells table-screen table">
            <div class="table-responsive" style="overflow: auto; height: calc(100vh - 220px);">
                <table class="table table-condensed table-bordered table-striped">
                    <thead style="position: sticky; top: 0; z-index: 1; background: #eee;">
                        <tr class="header-table">
                            <th rowspan="3" class="frozen">Khách hàng</th>
                            <th rowspan="3">Sản lượng</th>
                            <th colspan="9">Chi tiết giá vốn (USD/tấn)</th>
                            <th rowspan="3">Tỷ giá</th>
                            <th colspan="2">Giá vốn</th>
                            <th colspan="7">Thành tiền (VNĐ)</th>
                        </tr>
                        <tr class="header-table">
                            <th rowspan="2">MOPS ($/tấn)</th>
                            <th rowspan="2">Pre+BH ($/tấn)</th>
                            <th rowspan="2">CIF ($/tấn)</th>
                            <th rowspan="2">Thuế ($/tấn)</th>
                            <th rowspan="2">CP mua hàng (đ/tấn)</th>
                            <th colspan="3">Hao hụt ($/tấn)</th>
                            <th rowspan="2">Phí FHS</th>

                            <th rowspan="2">Cộng đ.giá (đ/tấn)</th>
                            <th rowspan="2">Tổng Giá vốn (trVNĐ)</th>
                            <th rowspan="2">MOPS</th>
                            <th rowspan="2">Premium & BH</th>
                            <th rowspan="2">Thuế NK</th>
                            <th rowspan="2">DV mua ngoài</th>
                            <th colspan="2">Hao hụt</th>
                            <th rowspan="2">FHS</th>
                        </tr>
                        <tr class="header-table">
                            <th>Cộng HH</th>
                            <th>CƯ</th>
                            <th>TN</th>
                            <th>HH CƯ</th>
                            <th>HH TN</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var item in Model.KeHoachGiaVonData.OrderBy(x => x.Order))
                        {
                            var space = new StringBuilder();
                            for (int i = 0; i < item.Level; i++)
                            {
                                space.Append("\t");
                            }
                            var bold = item.IsBold == true ? "bold" : "";
                            <tr style="font-weight:@bold">
                                <td class="pre-whitespace frozen">@($"{space.ToString()}{item.Name}")</td>
                                <td class="align-right">@(item.Value1.ToStringVN() == "0" ? "" : item.Value1.ToStringVN())</td>
                                <td class="align-center">@(item.Value2.ToStringVN() == "0" ? "" : item.Value2.ToStringVN())</td>
                                <td class="align-center">@(item.Value3.ToStringVN() == "0" ? "" : item.Value3.ToStringVN())</td>
                                <td class="align-center">@(item.Value4.ToStringVN() == "0" ? "" : item.Value4.ToStringVN())</td>
                                <td class="align-center">@(item.Value5.ToStringVN() == "0" ? "" : item.Value5.ToStringVN())</td>
                                <td class="align-center">@(item.Value6.ToStringVN() == "0" ? "" : item.Value6.ToStringVN())</td>
                                <td class="align-center">@(item.Value7.ToStringVN() == "0" ? "" : item.Value7.ToStringVN())</td>
                                <td class="align-center">@(item.Value8.ToStringVN() == "0" ? "" : item.Value8.ToStringVN())</td>
                                <td class="align-center">@(item.Value9.ToStringVN() == "0" ? "" : item.Value9.ToStringVN())</td>
                                <td class="align-center">@(item.Value10.ToStringVN() == "0" ? "" : item.Value10.ToStringVN())</td>
                                <td class="align-center">@(item.Value11.ToStringVN() == "0" ? "" : item.Value11.ToStringVN())</td>
                                <td class="align-center">@(item.Value12.ToStringVN() == "0" ? "" : item.Value12.ToStringVN())</td>
                                <td class="align-center">@(item.Value13.ToStringVN() == "0" ? "" : item.Value13.ToStringVN())</td>
                                <td class="align-center">@(item.Value14.ToStringVN() == "0" ? "" : item.Value14.ToStringVN())</td>
                                <td class="align-center">@(item.Value15.ToStringVN() == "0" ? "" : item.Value15.ToStringVN())</td>
                                <td class="align-center">@(item.Value16.ToStringVN() == "0" ? "" : item.Value16.ToStringVN())</td>
                                <td class="align-center">@(item.Value17.ToStringVN() == "0" ? "" : item.Value17.ToStringVN())</td>
                                <td class="align-center">@(item.Value18.ToStringVN() == "0" ? "" : item.Value18.ToStringVN())</td>
                                <td class="align-center">@(item.Value19.ToStringVN() == "0" ? "" : item.Value19.ToStringVN())</td>
                                <td class="align-center">@(item.Value20.ToStringVN() == "0" ? "" : item.Value20.ToStringVN())</td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</div>
